import{c as se,g as Le,r as m,R as A,a as ee,j as c,C as _e,M as $,G as je,U as Se,P as Oe,S as Ie,b as Pe,d as Fe}from"./index-BwcOJfob.js";import{K as J}from"./key-kuAPxK1B.js";import{T as De}from"./tag-LE5UJ5Yq.js";const Te=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Re=se("maximize-2",Te);const ze=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],ae=se("minimize-2",ze);const Ze=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ue=se("minus",Ze);var W,le;function Be(){return le||(le=1,W=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,s,o;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(s=n;s--!==0;)if(!r(e[s],t[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[s]))return!1;for(s=n;s--!==0;){var i=o[s];if(!r(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}),W}var $e=Be();const te=Le($e);function Ge(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function He(r){var e=Ge(r,"string");return typeof e=="symbol"?e:String(e)}function j(){return j=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},j.apply(this,arguments)}function P(r,e){if(r==null)return{};var t={},n=Object.keys(r),s,o;for(o=0;o<n.length;o++)s=n[o],!(e.indexOf(s)>=0)&&(t[s]=r[s]);return t}const _={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"},Ve="https://maps.googleapis.com/maps/api/js";class U{static async load(e,t){var n;const s=e.libraries?e.libraries.split(","):[],o=this.serializeParams(e);this.listeners.push(t),(n=window.google)!=null&&(n=n.maps)!=null&&n.importLibrary?(this.serializedApiParams||(this.loadingStatus=_.LOADED),this.notifyLoadingStatusListeners()):(this.serializedApiParams=o,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams!==o&&console.warn("[google-maps-api-loader] The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect.");const i=["maps",...s];await Promise.all(i.map(l=>google.maps.importLibrary(l)))}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary){console.error("[google-maps-api-loader-internal]: initImportLibrary must only be called once");return}let t=null;const n=()=>t||(t=new Promise((s,o)=>{var i;const l=document.createElement("script"),a=new URLSearchParams;for(const[h,u]of Object.entries(e)){const d=h.replace(/[A-Z]/g,g=>"_"+g[0].toLowerCase());a.set(d,u)}a.set("loading","async"),a.set("callback","__googleMapsCallback__"),l.async=!0,l.src=Ve+"?"+a.toString(),l.nonce=((i=document.querySelector("script[nonce]"))==null?void 0:i.nonce)||"",l.onerror=()=>{this.loadingStatus=_.FAILED,this.notifyLoadingStatusListeners(),o(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=_.LOADED,this.notifyLoadingStatusListeners(),s()},window.gm_authFailure=()=>{this.loadingStatus=_.AUTH_FAILURE,this.notifyLoadingStatusListeners()},this.loadingStatus=_.LOADING,this.notifyLoadingStatusListeners(),document.head.append(l)}),t);google.maps.importLibrary=s=>n().then(()=>google.maps.importLibrary(s))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}U.loadingStatus=_.NOT_LOADED;U.serializedApiParams=void 0;U.listeners=[];const Ke=["onLoad","apiKey","version","libraries"],qe=["children"],Je="GMP_visgl_rgmlibrary_v1_default",B=A.createContext(null);function We(){const[r,e]=m.useState({});return{mapInstances:r,addMapInstance:(o,i="default")=>{e(l=>j({},l,{[i]:o}))},removeMapInstance:(o="default")=>{e(i=>P(i,[o].map(He)))},clearMapInstances:()=>{e({})}}}function Ye(r){const{onLoad:e,apiKey:t,version:n,libraries:s=[]}=r,o=P(r,Ke),[i,l]=m.useState(U.loadingStatus),[a,h]=m.useReducer((f,p)=>j({},f,{[p.name]:p.value}),{}),u=m.useMemo(()=>s?.join(","),[s]),d=m.useMemo(()=>JSON.stringify(j({apiKey:t,version:n},o)),[t,n,o]),g=m.useCallback(async f=>{var p;if(a[f])return a[f];if(!((p=google)!=null&&(p=p.maps)!=null&&p.importLibrary))throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const x=await window.google.maps.importLibrary(f);return h({name:f,value:x}),x},[a]);return m.useEffect(()=>{(async()=>{try{const f=j({key:t},o);n&&(f.v=n),u?.length>0&&(f.libraries=u),f.solutionChannel===void 0?f.solutionChannel=Je:f.solutionChannel===""&&delete f.solutionChannel,await U.load(f,p=>l(p));for(const p of["core","maps",...s])await g(p);e&&e()}catch(f){console.error("<ApiProvider> failed to load the Google Maps JavaScript API",f)}})()},[t,u,d]),{status:i,loadedLibraries:a,importLibrary:g}}const Qe=r=>{const{children:e}=r,t=P(r,qe),{mapInstances:n,addMapInstance:s,removeMapInstance:o,clearMapInstances:i}=We(),{status:l,loadedLibraries:a,importLibrary:h}=Ye(t),u=m.useMemo(()=>({mapInstances:n,addMapInstance:s,removeMapInstance:o,clearMapInstances:i,status:l,loadedLibraries:a,importLibrary:h}),[n,s,o,i,l,a,h]);return A.createElement(B.Provider,{value:u},e)};function Xe(r,e){for(const t of rt){const n=e[t],s=pe[t];m.useEffect(()=>{if(!r||!n)return;const o=google.maps.event.addListener(r,s,i=>{n(et(s,r,i))});return()=>o.remove()},[r,s,n])}}function et(r,e,t){const n={type:r,map:e,detail:{},stoppable:!1,stop:()=>{}};if(tt.includes(r)){const o=n,i=e.getCenter(),l=e.getZoom(),a=e.getHeading()||0,h=e.getTilt()||0,u=e.getBounds();return(!i||!u||!Number.isFinite(l))&&console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),o.detail={center:i?.toJSON()||{lat:0,lng:0},zoom:l||0,heading:a,tilt:h,bounds:u?.toJSON()||{north:90,east:180,south:-90,west:-180}},o}else if(nt.includes(r)){var s;if(!t)throw new Error("[createEvent] mouse events must provide a srcEvent");const o=n;return o.domEvent=t.domEvent,o.stoppable=!0,o.stop=()=>t.stop(),o.detail={latLng:((s=t.latLng)==null?void 0:s.toJSON())||null,placeId:t.placeId},o}return n}const pe={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},tt=["bounds_changed","center_changed","heading_changed","tilt_changed","zoom_changed"],nt=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],rt=Object.keys(pe);function xe(r,e){const t=m.useRef(void 0);(!t.current||!te(e,t.current))&&(t.current=e),m.useEffect(r,t.current)}const st=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","zoomControl","zoomControlOptions"]);function ot(r,e){const t={},n=Object.keys(e);for(const s of n)st.has(s)&&(t[s]=e[s]);xe(()=>{r&&r.setOptions(t)},[t])}function be(){var r;return((r=m.useContext(B))==null?void 0:r.status)||_.NOT_LOADED}function it(r,e){const{viewport:t,viewState:n}=e,s=!!t;return m.useLayoutEffect(()=>{if(!r||!n)return;const{latitude:o,longitude:i,bearing:l,pitch:a,zoom:h}=n;r.moveCamera({center:{lat:o,lng:i},heading:l,tilt:a,zoom:h+1})},[r,n]),s}function at(r){return!r||typeof r!="object"||!("lat"in r&&"lng"in r)?!1:Number.isFinite(r.lat)&&Number.isFinite(r.lng)}function ye(r){return at(r)?r:r.toJSON()}function lt(r,e,t){const n=t.center?ye(t.center):null;let s=null,o=null;n&&Number.isFinite(n.lat)&&Number.isFinite(n.lng)&&(s=n.lat,o=n.lng);const i=Number.isFinite(t.zoom)?t.zoom:null,l=Number.isFinite(t.heading)?t.heading:null,a=Number.isFinite(t.tilt)?t.tilt:null;m.useLayoutEffect(()=>{if(!r)return;const h={};let u=!1;s!==null&&o!==null&&(e.current.center.lat!==s||e.current.center.lng!==o)&&(h.center={lat:s,lng:o},u=!0),i!==null&&e.current.zoom!==i&&(h.zoom=i,u=!0),l!==null&&e.current.heading!==l&&(h.heading=l,u=!0),a!==null&&e.current.tilt!==a&&(h.tilt=a,u=!0),u&&r.moveCamera(h)})}const ct=()=>{const r={position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"};return A.createElement("div",{style:r},A.createElement("h2",null,"Error: AuthFailure"),A.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",A.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."))};function ut(){const[r,e]=m.useState(null),t=m.useCallback(n=>e(n),[e]);return[r,t]}function we(){return be()===_.LOADED}function dt(){const[,r]=m.useReducer(e=>e+1,0);return r}function ht(r,e){const t=r.getCenter(),n=r.getZoom(),s=r.getHeading()||0,o=r.getTilt()||0,i=r.getBounds();(!t||!i||!Number.isFinite(n))&&console.warn("[useTrackedCameraState] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),Object.assign(e.current,{center:t?.toJSON()||{lat:0,lng:0},zoom:n||0,heading:s,tilt:o})}function ft(r){const e=dt(),t=m.useRef({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return m.useEffect(()=>{if(!r)return;const n=google.maps.event.addListener(r,"bounds_changed",()=>{ht(r,t),e()});return()=>n.remove()},[r,e]),t}const gt=["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt","reuseMaps"],mt=["padding"];class V{static has(e){return this.entries[e]&&this.entries[e].length>0}static pop(e){return this.entries[e]&&this.entries[e].pop()||null}static push(e,t){this.entries[e]||(this.entries[e]=[]),this.entries[e].push(t)}}V.entries={};function pt(r,e){const t=we(),[n,s]=m.useState(null),[o,i]=ut(),l=ft(n),{id:a,defaultBounds:h,defaultCenter:u,defaultZoom:d,defaultHeading:g,defaultTilt:f,reuseMaps:p}=r,x=P(r,gt),y=r.zoom!==void 0||r.defaultZoom!==void 0,b=r.center!==void 0||r.defaultCenter!==void 0;!h&&(!y||!b)&&console.warn("<Map> component is missing configuration. You have to provide zoom and center (via the `zoom`/`defaultZoom` and `center`/`defaultCenter` props) or specify the region to show using `defaultBounds`. See https://visgl.github.io/react-google-maps/docs/api-reference/components/map#required"),!x.center&&u&&(x.center=u),!x.zoom&&Number.isFinite(d)&&(x.zoom=d),!x.heading&&Number.isFinite(g)&&(x.heading=g),!x.tilt&&Number.isFinite(f)&&(x.tilt=f);for(const v of Object.keys(x))x[v]===void 0&&delete x[v];const w=m.useRef();return m.useEffect(()=>{if(!o||!t)return;const{addMapInstance:v,removeMapInstance:C}=e,k=r.mapId,M=k||"default";let E,N;if(p&&V.has(M)?(N=V.pop(M),E=N.getDiv(),o.appendChild(E),N.setOptions(x),setTimeout(()=>N.setCenter(N.getCenter()),0)):(E=document.createElement("div"),E.style.height="100%",o.appendChild(E),N=new google.maps.Map(E,x)),s(N),v(N,a),h){const{padding:K}=h,q=P(h,mt);N.fitBounds(q,K)}else(!y||!b)&&N.fitBounds({east:180,west:-180,south:-90,north:90});if(w.current){const{mapId:K,cameraState:q}=w.current;K!==k&&N.setOptions(q)}return()=>{w.current={mapId:k,cameraState:l.current},E.remove(),p?V.push(M,N):google.maps.event.clearInstanceListeners(N),s(null),C(a)}},[o,t,a,r.mapId]),[n,i,l]}const ve=A.createContext(null),Ce=r=>{const{children:e,id:t,className:n,style:s}=r,o=m.useContext(B),i=be();if(!o)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[l,a,h]=pt(r,o);lt(l,h,r),Xe(l,r),ot(l,r);const u=it(l,r),d=!!r.controlled;m.useEffect(()=>{if(l)return u&&l.setOptions({disableDefaultUI:!0}),(u||d)&&l.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{l.setOptions({gestureHandling:r.gestureHandling,keyboardShortcuts:r.keyboardShortcuts})}},[l,u,d,r.gestureHandling,r.keyboardShortcuts]);const g=r.center?ye(r.center):null;let f=null,p=null;g&&Number.isFinite(g.lat)&&Number.isFinite(g.lng)&&(f=g.lat,p=g.lng);const x=m.useMemo(()=>{var w,v,C,k,M;return{center:{lat:(w=f)!=null?w:0,lng:(v=p)!=null?v:0},zoom:(C=r.zoom)!=null?C:0,heading:(k=r.heading)!=null?k:0,tilt:(M=r.tilt)!=null?M:0}},[f,p,r.zoom,r.heading,r.tilt]);m.useLayoutEffect(()=>{if(!l||!d)return;l.moveCamera(x);const w=l.addListener("bounds_changed",()=>{l.moveCamera(x)});return()=>w.remove()},[l,d,x]);const y=m.useMemo(()=>j({width:"100%",height:"100%",position:"relative",zIndex:u?-1:0},s),[s,u]),b=m.useMemo(()=>({map:l}),[l]);return i===_.AUTH_FAILURE?A.createElement("div",{style:j({position:"relative"},n?{}:y),className:n},A.createElement(ct,null)):A.createElement("div",j({ref:a,"data-testid":"map",style:n?void 0:y,className:n},t?{id:t}:{}),l?A.createElement(ve.Provider,{value:b},e):null)};Ce.deckGLViewProps=!0;const ce=new Set;function xt(...r){const e=JSON.stringify(r);ce.has(e)||(ce.add(e),console.error(...r))}const D=(r=null)=>{const e=m.useContext(B),{map:t}=m.useContext(ve)||{};if(e===null)return xt("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:n}=e;return r!==null?n[r]||null:t||n.default||null};function Me(r){const e=we(),t=m.useContext(B);return m.useEffect(()=>{!e||!t||t.importLibrary(r)},[e,t,r]),t?.loadedLibraries[r]||null}function ke(r,e,t){if(e!=null&&typeof e!="object")throw new Error("The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.");const n=r.style;if(t==null){if(e==null)return;for(const s in e)e.hasOwnProperty(s)&&ue(n,s,e[s]);return}for(const s in t)t.hasOwnProperty(s)&&(e==null||!e.hasOwnProperty(s))&&(s.indexOf("--")===0?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="");if(e!=null)for(const s in e){const o=e[s];e.hasOwnProperty(s)&&t[s]!==o&&ue(n,s,o)}}function ue(r,e,t){const n=e.indexOf("--")===0;t==null||typeof t=="boolean"||t===""?n?r.setProperty(e,""):e==="float"?r.cssFloat="":r[e]="":n?r.setProperty(e,t):typeof t=="number"&&t!==0&&!yt(e)?r[e]=t+"px":e==="float"?r.cssFloat=t:r[e]=(""+t).trim()}const bt=new Set(["animationIterationCount","aspectRatio","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","fontWeight","lineClamp","lineHeight","opacity","order","orphans","scale","tabSize","widows","zIndex","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth"]);function yt(r){return bt.has(r)}function F(r,e,t){m.useEffect(()=>{if(!r||!e||!t)return;const n=google.maps.event.addListener(r,e,t);return()=>n.remove()},[r,e,t])}function T(r,e,t){m.useEffect(()=>{r&&(r[e]=t)},[r,e,t])}const wt=A.createContext(null);function vt(r){const[e,t]=m.useState(null),[n,s]=m.useState(null),o=m.useRef(null),i=D(),l=Me("marker"),{children:a,className:h,style:u,onClick:d,onDrag:g,onDragStart:f,onDragEnd:p,collisionBehavior:x,clickable:y,draggable:b,position:w,title:v,zIndex:C}=r,k=m.Children.count(a);return m.useEffect(()=>{if(!i||!l)return;const M=new l.AdvancedMarkerElement;M.map=i,t(M);let E=null;return k>0&&(E=document.createElement("div"),M.content=E,s(E)),()=>{var N;M.map=null,(N=E)==null||N.remove(),t(null),s(null)}},[i,l,k]),m.useEffect(()=>{!e||!e.content||(e.content.className=h||"")},[e,h]),T(n,"className",h??""),m.useEffect(()=>{n&&(ke(n,u||null,o.current),o.current=u||null)},[n,h,u]),T(e,"position",w),T(e,"title",v??""),T(e,"zIndex",C),T(e,"collisionBehavior",x),m.useEffect(()=>{e&&(b!==void 0?e.gmpDraggable=b:g||f||p?e.gmpDraggable=!0:e.gmpDraggable=!1)},[e,b,g,p,f]),m.useEffect(()=>{e&&(y!==void 0?e.gmpClickable=y:d?e.gmpClickable=!0:e.gmpClickable=!1)},[e,y,d]),F(e,"click",d),F(e,"drag",g),F(e,"dragstart",f),F(e,"dragend",p),[e,n]}m.forwardRef((r,e)=>{const{children:t}=r,[n,s]=vt(r),o=m.useMemo(()=>n?{marker:n}:null,[n]);return m.useImperativeHandle(e,()=>n,[n]),s?A.createElement(wt.Provider,{value:o},ee.createPortal(t,s)):null});const Ct=["children","headerContent","style","className","pixelOffset","anchor","shouldFocus","onClose","onCloseClick"],Mt=r=>{const{children:e,headerContent:t,style:n,className:s,pixelOffset:o,anchor:i,shouldFocus:l,onClose:a,onCloseClick:h}=r,u=P(r,Ct),d=Me("maps"),[g,f]=m.useState(null),p=m.useRef(null),x=m.useRef(null);m.useEffect(()=>{if(!d)return;p.current=document.createElement("div"),x.current=document.createElement("div");const w=u;o&&(w.pixelOffset=new google.maps.Size(o[0],o[1])),t&&(w.headerContent=typeof t=="string"?t:x.current);const v=new google.maps.InfoWindow(u);return v.setContent(p.current),f(v),()=>{var C,k;v.setContent(null),(C=p.current)==null||C.remove(),(k=x.current)==null||k.remove(),p.current=null,x.current=null,f(null)}},[d]);const y=m.useRef(null);m.useEffect(()=>{!g||!p.current||(ke(p.current,n||null,y.current),y.current=n||null,s!==p.current.className&&(p.current.className=s||""))},[g,s,n]),xe(()=>{if(!g)return;const w=u;o?w.pixelOffset=new google.maps.Size(o[0],o[1]):w.pixelOffset=null,t?w.headerContent=typeof t=="string"?t:x.current:w.headerContent=null,g.setOptions(u)},[u,o,t]),F(g,"close",a),F(g,"closeclick",h);const b=D();return m.useEffect(()=>{if(!b||!g||i===null)return;const w=!!i,v={map:b};return i&&(v.anchor=i),l!==void 0&&(v.shouldFocus=l),g.open(v),()=>{w&&g.set("anchor",null),g.close()}},[g,i,b,l]),A.createElement(A.Fragment,null,p.current&&ee.createPortal(e,p.current),x.current!==null&&ee.createPortal(t,x.current))},kt=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"];function Et(r){const[e,t]=m.useState(null),n=D(),{onClick:s,onDrag:o,onDragStart:i,onDragEnd:l,onMouseOver:a,onMouseOut:h}=r,u=P(r,kt),{position:d,draggable:g}=u;return m.useEffect(()=>{if(!n){n===void 0&&console.error("<Marker> has to be inside a Map component.");return}const f=new google.maps.Marker(u);return f.setMap(n),t(f),()=>{f.setMap(null),t(null)}},[n]),m.useEffect(()=>{if(!e)return;const f=e,p=google.maps.event;return s&&p.addListener(f,"click",s),o&&p.addListener(f,"drag",o),i&&p.addListener(f,"dragstart",i),l&&p.addListener(f,"dragend",l),a&&p.addListener(f,"mouseover",a),h&&p.addListener(f,"mouseout",h),e.setDraggable(!!g),()=>{p.clearInstanceListeners(f)}},[e,g,s,o,i,l,a,h]),m.useEffect(()=>{e&&u&&e.setOptions(u)},[e,u]),m.useEffect(()=>{g||!d||!e||e.setPosition(d)},[g,d,e]),e}m.forwardRef((r,e)=>{const t=Et(r);return m.useImperativeHandle(e,()=>t,[t]),A.createElement(A.Fragment,null)});const de=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Y=1,R=8;class oe{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,n]=new Uint8Array(e,0,2);if(t!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=n>>4;if(s!==Y)throw new Error(`Got v${s} data when expected v${Y}.`);const o=de[n&15];if(!o)throw new Error("Unrecognized array type.");const[i]=new Uint16Array(e,2,1),[l]=new Uint32Array(e,4,1);return new oe(l,i,o,e)}constructor(e,t=64,n=Float64Array,s){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const o=de.indexOf(this.ArrayType),i=e*2*this.ArrayType.BYTES_PER_ELEMENT,l=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-l%8)%8;if(o<0)throw new Error(`Unexpected typed array class: ${n}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,R,e),this.coords=new this.ArrayType(this.data,R+l+a,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(R+i+l+a),this.ids=new this.IndexArrayType(this.data,R,e),this.coords=new this.ArrayType(this.data,R+l+a,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(Y<<4)+o]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return ne(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,n,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:i,nodeSize:l}=this,a=[0,o.length-1,0],h=[];for(;a.length;){const u=a.pop()||0,d=a.pop()||0,g=a.pop()||0;if(d-g<=l){for(let y=g;y<=d;y++){const b=i[2*y],w=i[2*y+1];b>=e&&b<=n&&w>=t&&w<=s&&h.push(o[y])}continue}const f=g+d>>1,p=i[2*f],x=i[2*f+1];p>=e&&p<=n&&x>=t&&x<=s&&h.push(o[f]),(u===0?e<=p:t<=x)&&(a.push(g),a.push(f-1),a.push(1-u)),(u===0?n>=p:s>=x)&&(a.push(f+1),a.push(d),a.push(1-u))}return h}within(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:o,nodeSize:i}=this,l=[0,s.length-1,0],a=[],h=n*n;for(;l.length;){const u=l.pop()||0,d=l.pop()||0,g=l.pop()||0;if(d-g<=i){for(let y=g;y<=d;y++)he(o[2*y],o[2*y+1],e,t)<=h&&a.push(s[y]);continue}const f=g+d>>1,p=o[2*f],x=o[2*f+1];he(p,x,e,t)<=h&&a.push(s[f]),(u===0?e-n<=p:t-n<=x)&&(l.push(g),l.push(f-1),l.push(1-u)),(u===0?e+n>=p:t+n>=x)&&(l.push(f+1),l.push(d),l.push(1-u))}return a}}function ne(r,e,t,n,s,o){if(s-n<=t)return;const i=n+s>>1;Ee(r,e,i,n,s,o),ne(r,e,t,n,i-1,1-o),ne(r,e,t,i+1,s,1-o)}function Ee(r,e,t,n,s,o){for(;s>n;){if(s-n>600){const h=s-n+1,u=t-n+1,d=Math.log(h),g=.5*Math.exp(2*d/3),f=.5*Math.sqrt(d*g*(h-g)/h)*(u-h/2<0?-1:1),p=Math.max(n,Math.floor(t-u*g/h+f)),x=Math.min(s,Math.floor(t+(h-u)*g/h+f));Ee(r,e,t,p,x,o)}const i=e[2*t+o];let l=n,a=s;for(z(r,e,n,t),e[2*s+o]>i&&z(r,e,n,s);l<a;){for(z(r,e,l,a),l++,a--;e[2*l+o]<i;)l++;for(;e[2*a+o]>i;)a--}e[2*n+o]===i?z(r,e,n,a):(a++,z(r,e,a,s)),a<=t&&(n=a+1),t<=a&&(s=a-1)}}function z(r,e,t,n){Q(r,t,n),Q(e,2*t,2*n),Q(e,2*t+1,2*n+1)}function Q(r,e,t){const n=r[e];r[e]=r[t],r[t]=n}function he(r,e,t,n){const s=r-t,o=e-n;return s*s+o*o}const Nt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:r=>r},fe=Math.fround||(r=>(e=>(r[0]=+e,r[0])))(new Float32Array(1)),I=2,O=3,X=4,S=5,Ne=6;class At{constructor(e){this.options=Object.assign(Object.create(Nt),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:n,maxZoom:s}=this.options;t&&console.time("total time");const o=`prepare ${e.length} points`;t&&console.time(o),this.points=e;const i=[];for(let a=0;a<e.length;a++){const h=e[a];if(!h.geometry)continue;const[u,d]=h.geometry.coordinates,g=fe(G(u)),f=fe(H(d));i.push(g,f,1/0,a,-1,1),this.options.reduce&&i.push(0)}let l=this.trees[s+1]=this._createTree(i);t&&console.timeEnd(o);for(let a=s;a>=n;a--){const h=+Date.now();l=this.trees[a]=this._createTree(this._cluster(l,a)),t&&console.log("z%d: %d clusters in %dms",a,l.numItems,+Date.now()-h)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let n=((e[0]+180)%360+360)%360-180;const s=Math.max(-90,Math.min(90,e[1]));let o=e[2]===180?180:((e[2]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,o=180;else if(n>o){const d=this.getClusters([n,s,180,i],t),g=this.getClusters([-180,s,o,i],t);return d.concat(g)}const l=this.trees[this._limitZoom(t)],a=l.range(G(n),H(i),G(o),H(s)),h=l.data,u=[];for(const d of a){const g=this.stride*d;u.push(h[g+S]>1?ge(h,g,this.clusterProps):this.points[h[g+O]])}return u}getChildren(e){const t=this._getOriginId(e),n=this._getOriginZoom(e),s="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(s);const i=o.data;if(t*this.stride>=i.length)throw new Error(s);const l=this.options.radius/(this.options.extent*Math.pow(2,n-1)),a=i[t*this.stride],h=i[t*this.stride+1],u=o.within(a,h,l),d=[];for(const g of u){const f=g*this.stride;i[f+X]===e&&d.push(i[f+S]>1?ge(i,f,this.clusterProps):this.points[i[f+O]])}if(d.length===0)throw new Error(s);return d}getLeaves(e,t,n){t=t||10,n=n||0;const s=[];return this._appendLeaves(s,e,t,n,0),s}getTile(e,t,n){const s=this.trees[this._limitZoom(e)],o=Math.pow(2,e),{extent:i,radius:l}=this.options,a=l/i,h=(n-a)/o,u=(n+1+a)/o,d={features:[]};return this._addTileFeatures(s.range((t-a)/o,h,(t+1+a)/o,u),s.data,t,n,o,d),t===0&&this._addTileFeatures(s.range(1-a/o,h,1,u),s.data,o,n,o,d),t===o-1&&this._addTileFeatures(s.range(0,h,a/o,u),s.data,-1,n,o,d),d.features.length?d:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const n=this.getChildren(e);if(t++,n.length!==1)break;e=n[0].properties.cluster_id}return t}_appendLeaves(e,t,n,s,o){const i=this.getChildren(t);for(const l of i){const a=l.properties;if(a&&a.cluster?o+a.point_count<=s?o+=a.point_count:o=this._appendLeaves(e,a.cluster_id,n,s,o):o<s?o++:e.push(l),e.length===n)break}return o}_createTree(e){const t=new oe(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<e.length;n+=this.stride)t.add(e[n],e[n+1]);return t.finish(),t.data=e,t}_addTileFeatures(e,t,n,s,o,i){for(const l of e){const a=l*this.stride,h=t[a+S]>1;let u,d,g;if(h)u=Ae(t,a,this.clusterProps),d=t[a],g=t[a+1];else{const x=this.points[t[a+O]];u=x.properties;const[y,b]=x.geometry.coordinates;d=G(y),g=H(b)}const f={type:1,geometry:[[Math.round(this.options.extent*(d*o-n)),Math.round(this.options.extent*(g*o-s))]],tags:u};let p;h||this.options.generateId?p=t[a+O]:p=this.points[t[a+O]].id,p!==void 0&&(f.id=p),i.features.push(f)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:n,extent:s,reduce:o,minPoints:i}=this.options,l=n/(s*Math.pow(2,t)),a=e.data,h=[],u=this.stride;for(let d=0;d<a.length;d+=u){if(a[d+I]<=t)continue;a[d+I]=t;const g=a[d],f=a[d+1],p=e.within(a[d],a[d+1],l),x=a[d+S];let y=x;for(const b of p){const w=b*u;a[w+I]>t&&(y+=a[w+S])}if(y>x&&y>=i){let b=g*x,w=f*x,v,C=-1;const k=((d/u|0)<<5)+(t+1)+this.points.length;for(const M of p){const E=M*u;if(a[E+I]<=t)continue;a[E+I]=t;const N=a[E+S];b+=a[E]*N,w+=a[E+1]*N,a[E+X]=k,o&&(v||(v=this._map(a,d,!0),C=this.clusterProps.length,this.clusterProps.push(v)),o(v,this._map(a,E)))}a[d+X]=k,h.push(b/y,w/y,1/0,k,-1,y),o&&h.push(C)}else{for(let b=0;b<u;b++)h.push(a[d+b]);if(y>1)for(const b of p){const w=b*u;if(!(a[w+I]<=t)){a[w+I]=t;for(let v=0;v<u;v++)h.push(a[w+v])}}}}return h}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,n){if(e[t+S]>1){const i=this.clusterProps[e[t+Ne]];return n?Object.assign({},i):i}const s=this.points[e[t+O]].properties,o=this.options.map(s);return n&&o===s?Object.assign({},o):o}}function ge(r,e,t){return{type:"Feature",id:r[e+O],properties:Ae(r,e,t),geometry:{type:"Point",coordinates:[Lt(r[e]),_t(r[e+1])]}}}function Ae(r,e,t){const n=r[e+S],s=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?`${Math.round(n/100)/10}k`:n,o=r[e+Ne],i=o===-1?{}:Object.assign({},t[o]);return Object.assign(i,{cluster:!0,cluster_id:r[e+O],point_count:n,point_count_abbreviated:s})}function G(r){return r/360+.5}function H(r){const e=Math.sin(r*Math.PI/180),t=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return t<0?0:t>1?1:t}function Lt(r){return(r-.5)*360}function _t(r){const e=(180-r*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function jt(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}class L{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,t){this.isAdvancedMarker(e)?e.map=t:e.setMap(t)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class re{constructor({markers:e,position:t}){this.markers=e,t&&(t instanceof google.maps.LatLng?this._position=t:this._position=new google.maps.LatLng(t))}get bounds(){if(this.markers.length===0&&!this._position)return;const e=new google.maps.LatLngBounds(this._position,this._position);for(const t of this.markers)e.extend(L.getPosition(t));return e}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>L.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(L.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class St{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return Ot(e)}}const Ot=r=>r.map(t=>new re({position:L.getPosition(t),markers:[t]}));class It extends St{constructor(e){var{maxZoom:t,radius:n=60}=e,s=jt(e,["maxZoom","radius"]);super({maxZoom:t}),this.state={zoom:-1},this.superCluster=new At(Object.assign({maxZoom:this.maxZoom,radius:n},s))}calculate(e){let t=!1;const n={zoom:e.map.getZoom()};if(!te(e.markers,this.markers)){t=!0,this.markers=[...e.markers];const s=this.markers.map(o=>{const i=L.getPosition(o);return{type:"Feature",geometry:{type:"Point",coordinates:[i.lng(),i.lat()]},properties:{marker:o}}});this.superCluster.load(s)}return t||(this.state.zoom<=this.maxZoom||n.zoom<=this.maxZoom)&&(t=!te(this.state,n)),this.state=n,t&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:t}}cluster({map:e}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(e.getZoom())).map(t=>this.transformCluster(t))}transformCluster({geometry:{coordinates:[e,t]},properties:n}){if(n.cluster)return new re({markers:this.superCluster.getLeaves(n.cluster_id,1/0).map(o=>o.properties.marker),position:{lat:t,lng:e}});const s=n.marker;return new re({markers:[s],position:L.getPosition(s)})}}class Pt{constructor(e,t){this.markers={sum:e.length};const n=t.map(o=>o.count),s=n.reduce((o,i)=>o+i,0);this.clusters={count:t.length,markers:{mean:s/t.length,sum:s,min:Math.min(...n),max:Math.max(...n)}}}}class Ft{render({count:e,position:t},n,s){const i=`<svg fill="${e>Math.max(10,n.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${e}</text>
</svg>`,l=`Cluster of ${e} markers`,a=Number(google.maps.Marker.MAX_ZINDEX)+e;if(L.isAdvancedMarkerAvailable(s)){const d=new DOMParser().parseFromString(i,"image/svg+xml").documentElement;d.setAttribute("transform","translate(0 25)");const g={map:s,position:t,zIndex:a,title:l,content:d};return new google.maps.marker.AdvancedMarkerElement(g)}const h={position:t,zIndex:a,title:l,icon:{url:`data:image/svg+xml;base64,${btoa(i)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(h)}}function Dt(r,e){for(let t in e.prototype)r.prototype[t]=e.prototype[t]}class ie{constructor(){Dt(ie,google.maps.OverlayView)}}var Z;(function(r){r.CLUSTERING_BEGIN="clusteringbegin",r.CLUSTERING_END="clusteringend",r.CLUSTER_CLICK="click"})(Z||(Z={}));const Tt=(r,e,t)=>{t.fitBounds(e.bounds)};class Rt extends ie{constructor({map:e,markers:t=[],algorithmOptions:n={},algorithm:s=new It(n),renderer:o=new Ft,onClusterClick:i=Tt}){super(),this.markers=[...t],this.clusters=[],this.algorithm=s,this.renderer=o,this.onClusterClick=i,e&&this.setMap(e)}addMarker(e,t){this.markers.includes(e)||(this.markers.push(e),t||this.render())}addMarkers(e,t){e.forEach(n=>{this.addMarker(n,!0)}),t||this.render()}removeMarker(e,t){const n=this.markers.indexOf(e);return n===-1?!1:(L.setMap(e,null),this.markers.splice(n,1),t||this.render(),!0)}removeMarkers(e,t){let n=!1;return e.forEach(s=>{n=this.removeMarker(s,!0)||n}),n&&!t&&this.render(),n}clearMarkers(e){this.markers.length=0,e||this.render()}render(){const e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,Z.CLUSTERING_BEGIN,this);const{clusters:t,changed:n}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(n||n==null){const s=new Set;for(const i of t)i.markers.length==1&&s.add(i.markers[0]);const o=[];for(const i of this.clusters)i.marker!=null&&(i.markers.length==1?s.has(i.marker)||L.setMap(i.marker,null):o.push(i.marker));this.clusters=t,this.renderClusters(),requestAnimationFrame(()=>o.forEach(i=>L.setMap(i,null)))}google.maps.event.trigger(this,Z.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>L.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){const e=new Pt(this.markers,this.clusters),t=this.getMap();this.clusters.forEach(n=>{n.markers.length===1?n.marker=n.markers[0]:(n.marker=this.renderer.render(n,e,t),n.markers.forEach(s=>L.setMap(s,null)),this.onClusterClick&&n.marker.addListener("click",s=>{google.maps.event.trigger(this,Z.CLUSTER_CLICK,n),this.onClusterClick(s,n,t)})),L.setMap(n.marker,t)})}}const zt=({clients:r})=>{const e=D(),t=m.useRef(0);return m.useEffect(()=>{if(!e||!window.google||r.length===0)return;if(Math.abs(r.length-t.current)>0){const s=new google.maps.LatLngBounds;let o=!1;if(r.forEach(i=>{i.lat&&i.lng&&(s.extend({lat:i.lat,lng:i.lng}),o=!0)}),o){e.fitBounds(s);const i=google.maps.event.addListenerOnce(e,"idle",()=>{e.getZoom()>16&&e.setZoom(16)});return t.current=r.length,()=>google.maps.event.removeListener(i)}}},[e,r]),null},Zt=()=>{const r=D();return r?c.jsxs("div",{className:"absolute bottom-[75px] right-4 flex flex-row gap-2 z-10",children:[c.jsx("button",{onClick:()=>r.setZoom((r.getZoom()||0)+1),className:"bg-white p-2.5 rounded-xl border border-outline-variant shadow-elevation-2 text-on-surface hover:bg-primary-container hover:text-primary transition-all active:scale-95 focus:outline-none",title:"Aproximar (Zoom In)","aria-label":"Aproximar zoom",children:c.jsx(Fe,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>r.setZoom((r.getZoom()||0)-1),className:"bg-white p-2.5 rounded-xl border border-outline-variant shadow-elevation-2 text-on-surface hover:bg-primary-container hover:text-primary transition-all active:scale-95 focus:outline-none",title:"Afastar (Zoom Out)","aria-label":"Afastar zoom",children:c.jsx(Ue,{className:"w-5 h-5"})})]}):null},Ut=r=>{switch(r){case"Norte":return{bg:"#10B981",border:"#047857",glyph:"#fff"};case"Nordeste":return{bg:"#F97316",border:"#C2410C",glyph:"#fff"};case"Centro-Oeste":return{bg:"#EAB308",border:"#A16207",glyph:"#fff"};case"Sudeste":return{bg:"#3B82F6",border:"#1D4ED8",glyph:"#fff"};case"Sul":return{bg:"#8B5CF6",border:"#5B21B6",glyph:"#fff"};default:return{bg:"#6B7280",border:"#374151",glyph:"#fff"}}},me=r=>{let e=0;for(let n=0;n<r.length;n++)e=r.charCodeAt(n)+((e<<5)-e);const t=(e&16777215).toString(16).toUpperCase();return"#"+"00000".substring(0,6-t.length)+t},Bt=`
<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
  <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/>
  <path d="M3 6h18"/>
  <path d="M16 10a4 4 0 0 1-8 0"/>
</svg>
`,$t=({clients:r,onClientSelect:e,productFilterActive:t,users:n,isClusteringEnabled:s})=>{const o=D(),i=m.useRef(null),l=m.useRef([]),a=m.useMemo(()=>{const u=document.createElement("div");return u.innerHTML=Bt,u.style.display="flex",u.style.alignItems="center",u.style.justifyContent="center",u},[]),h=m.useMemo(()=>{const u=new Map;return n&&n.forEach(d=>{let g={bg:"#6B7280",border:"#374151",glyph:"#fff"};d.color?g={bg:d.color,border:"black",glyph:"#fff"}:g={bg:me(d.id+d.name),border:"black",glyph:"#fff"},u.set(d.id,g)}),u},[n]);return m.useEffect(()=>{if(!o||!google.maps.marker)return;i.current&&(i.current.clearMarkers(),i.current.setMap(null)),l.current.forEach(p=>{p.map=null,google.maps.event.clearInstanceListeners(p)}),l.current=[],s?i.current=new Rt({map:o,markers:[]}):i.current=null;let u=!0,d=0;const g=200,f=()=>{if(!u||!google.maps.marker)return;const p=r.slice(d,d+g);if(p.length===0)return;const x=p.filter(y=>{const b=Number(y.lat),w=Number(y.lng);return!isNaN(b)&&!isNaN(w)&&b!==0&&w!==0}).map(y=>{let b={bg:"#6B7280",border:"#374151",glyph:"#fff"};if(t)b={bg:"#F43F5E",border:"#BE123C",glyph:"#fff"};else{const M=h.get(y.salespersonId);M?b=M:y.ownerName?b={bg:me(y.ownerName),border:"black",glyph:"#fff"}:b=Ut(y.region)}let w=null;t&&(w=a.cloneNode(!0),w.style.color=b.glyph);const v={background:b.bg,borderColor:b.border,glyphColor:b.glyph,scale:1};w&&(v.glyph=w);const C=new google.maps.marker.PinElement(v),k=new google.maps.marker.AdvancedMarkerElement({position:{lat:y.lat,lng:y.lng},content:C.element,map:s?null:o,title:y.companyName});return k.addListener("click",()=>{e(y.id)}),k});u&&(s&&i.current&&i.current.addMarkers(x),l.current.push(...x)),d+=g,d<r.length&&requestAnimationFrame(f)};return f(),()=>{u=!1,i.current&&(i.current.clearMarkers(),i.current.setMap(null)),l.current.forEach(p=>{p.map=null})}},[o,r,t,e,a,h,s]),c.jsx(zt,{clients:r})},Kt=({clients:r,apiKey:e,onInvalidKey:t,productFilterActive:n,highlightProductTerm:s,activeProductCategory:o,users:i,filterContent:l})=>{const a={lat:-14.235,lng:-51.9253},[h,u]=m.useState(null),[d,g]=m.useState(!1),[f,p]=m.useState(!1),[x,y]=m.useState(!0),b=r.find(C=>C.id===h);m.useEffect(()=>(e&&g(!1),window.gm_authFailure=()=>{console.error("Google Maps Auth Failure detected via gm_authFailure."),g(!0)},()=>{window.gm_authFailure=()=>{};const C=document.getElementsByTagName("script");for(let k=C.length-1;k>=0;k--){const M=C[k];M.src&&M.src.includes("maps.googleapis.com/maps/api/js")&&M.parentNode?.removeChild(M)}}),[e]);const w=()=>{p(!f)};if(!e)return c.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-gray-50 rounded-xl border border-blue-200 p-8 text-center",children:[c.jsx("div",{className:"w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mb-4",children:c.jsx(J,{className:"w-8 h-8"})}),c.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Configurar API Key"}),c.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md",children:[c.jsx(J,{className:"w-4 h-4"})," Selecionar API Key"]})]});if(d)return c.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center bg-gray-50 rounded-xl border border-red-200 p-8 text-center",children:[c.jsx("div",{className:"w-16 h-16 bg-red-100 text-red-600 rounded-full flex items-center justify-center mb-4",children:c.jsx(_e,{className:"w-8 h-8"})}),c.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Erro de Autenticação do Mapa"}),c.jsx("p",{className:"text-sm text-gray-600 mb-4 max-w-xs",children:'A chave de API atual é inválida para o Google Maps. Certifique-se de que a API "Maps JavaScript" está habilitada no console do Google Cloud.'}),c.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors shadow-md",children:[c.jsx(J,{className:"w-4 h-4"})," Trocar API Key"]})]});const v=f?"fixed inset-0 z-50 bg-white h-screen w-screen":"h-full w-full rounded-lg overflow-hidden shadow-sm border border-gray-200 relative z-0";return c.jsx("div",{className:v,children:c.jsx(Qe,{apiKey:e,libraries:["marker"],onLoad:()=>console.log("Maps API loaded"),children:c.jsxs(Ce,{defaultCenter:a,defaultZoom:4,mapId:"DEMO_MAP_ID",style:{width:"100%",height:"100%"},gestureHandling:"greedy",disableDefaultUI:!0,reuseMaps:!0,children:[c.jsx($t,{clients:r,onClientSelect:u,productFilterActive:n,users:i,isClusteringEnabled:x}),c.jsx(Zt,{}),f&&l&&c.jsxs("div",{className:"absolute top-0 left-0 right-0 z-30 bg-white/95 backdrop-blur-sm shadow-md border-b border-gray-200",children:[l,c.jsxs("div",{className:"flex justify-end gap-2 px-3 py-1.5 border-t border-gray-100 bg-gray-50/80",children:[c.jsx("button",{onClick:()=>y(!x),className:`p-1.5 px-3 rounded-lg border text-gray-600 transition-colors shadow-sm focus:outline-none flex items-center gap-2 text-xs font-bold ${x?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-200 hover:bg-gray-50"}`,title:x?"Desativar Agrupamento":"Ativar Agrupamento",children:x?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex -space-x-1",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),c.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500/50"})]}),"Agrupado"]}):c.jsxs(c.Fragment,{children:[c.jsx($,{className:"w-3 h-3"}),"Solto"]})}),c.jsxs("button",{onClick:w,className:"bg-white p-1.5 px-3 rounded-lg border border-gray-200 text-gray-600 hover:bg-gray-50 hover:text-blue-600 transition-colors shadow-sm focus:outline-none flex items-center gap-2 text-xs font-bold",title:"Sair da Tela Cheia",children:[c.jsx(ae,{className:"w-4 h-4"}),"Sair"]})]})]}),!f&&c.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 z-10",children:[c.jsx("button",{onClick:()=>y(!x),className:`p-2 rounded-lg border text-gray-600 transition-colors shadow-sm focus:outline-none flex items-center gap-2 text-xs font-bold ${x?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-200 hover:bg-gray-50"}`,title:x?"Desativar Agrupamento":"Ativar Agrupamento",children:x?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex -space-x-1",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),c.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500/50"})]}),"Agrupado"]}):c.jsxs(c.Fragment,{children:[c.jsx($,{className:"w-3 h-3"}),"Solto"]})}),c.jsx("button",{onClick:w,className:"bg-white p-2 rounded-lg border border-gray-200 text-gray-600 hover:bg-gray-50 hover:text-blue-600 transition-colors shadow-sm focus:outline-none",title:"Tela Cheia",children:c.jsx(Re,{className:"w-5 h-5"})})]}),f&&!l&&c.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 z-10",children:[c.jsx("button",{onClick:()=>y(!x),className:`p-2 rounded-lg border text-gray-600 transition-colors shadow-sm focus:outline-none flex items-center gap-2 text-xs font-bold ${x?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-200 hover:bg-gray-50"}`,title:x?"Desativar Agrupamento":"Ativar Agrupamento",children:x?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex -space-x-1",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),c.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500/50"})]}),"Agrupado"]}):c.jsxs(c.Fragment,{children:[c.jsx($,{className:"w-3 h-3"}),"Solto"]})}),c.jsx("button",{onClick:w,className:"bg-white p-2 rounded-lg border border-gray-200 text-gray-600 hover:bg-gray-50 hover:text-blue-600 transition-colors shadow-sm focus:outline-none",title:"Sair da Tela Cheia",children:c.jsx(ae,{className:"w-5 h-5"})})]}),b&&c.jsx(Mt,{position:{lat:b.lat,lng:b.lng},onCloseClick:()=>u(null),headerContent:c.jsxs("div",{className:"font-bold text-gray-800 text-sm flex items-center gap-2 pr-4",children:[c.jsx(Pe,{className:"w-4 h-4 text-blue-600"}),b.companyName]}),children:c.jsx("div",{className:"min-w-[240px] max-w-[320px] p-1",children:c.jsxs("div",{className:"space-y-2 text-xs text-gray-600 mt-1",children:[c.jsxs("div",{className:"flex items-center gap-1 text-[10px] uppercase font-bold text-gray-400",children:[c.jsx(je,{className:"w-3 h-3"}),b.city," - ",b.state," (",b.region,")"]}),c.jsxs("p",{className:"flex items-center gap-2",children:[c.jsx(Se,{className:"w-3 h-3 text-gray-400"}),c.jsx("span",{className:"font-medium text-gray-700",children:b.ownerName||"Não informado"})]}),c.jsxs("p",{className:"flex items-center gap-2",children:[c.jsx(Oe,{className:"w-3 h-3 text-gray-400"}),c.jsx("span",{className:"font-medium text-gray-700",children:b.contact||"Sem contato"})]}),c.jsxs("div",{className:"flex items-center gap-2 mt-1 mb-1 text-[10px] font-medium text-gray-600 bg-gray-50 px-2 py-1 rounded border border-gray-100 w-fit",children:[c.jsxs("span",{className:"flex items-center gap-1",title:"Total de itens comprados",children:[c.jsx("span",{className:"font-bold text-gray-800",children:b.purchasedProducts?.length||0})," Prod."]}),c.jsx("div",{className:"h-3 w-px bg-gray-300"}),c.jsxs("span",{className:"flex items-center gap-1",title:"Quantidade de SKUs únicos",children:[c.jsx("span",{className:"font-bold text-gray-800",children:new Set(b.purchasedProducts?.map(C=>C.sku)||[]).size})," SKUs"]})]}),c.jsxs("p",{className:"flex items-start gap-2",children:[c.jsx($,{className:"w-3 h-3 mt-0.5 text-gray-400 flex-shrink-0"}),c.jsx("span",{className:"leading-tight",children:b.cleanAddress})]}),b.purchasedProducts&&b.purchasedProducts.length>0&&c.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[c.jsxs("p",{className:"text-[10px] uppercase font-bold text-blue-600 mb-1.5 flex items-center gap-1",children:[c.jsx(Ie,{className:"w-3.5 h-3.5"}),"Produtos Adquiridos"]}),c.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1.5 pr-2 custom-scrollbar",children:b.purchasedProducts.map((C,k)=>{const M=s?.toLowerCase()||"",E=M&&((C.name||"").toLowerCase().includes(M)||(C.sku||"").toLowerCase().includes(M)||(C.brand||"").toLowerCase().includes(M)||(C.factoryCode||"").toLowerCase().includes(M));return c.jsxs("div",{className:`${E?"bg-amber-50 border-amber-200 ring-1 ring-amber-100":"bg-gray-50 border-gray-100"} p-2 rounded-lg border flex flex-col gap-0.5 transition-all shadow-sm`,children:[c.jsxs("div",{className:"flex justify-between items-start gap-2",children:[c.jsx("span",{className:`text-[10px] font-black leading-tight ${E?"text-amber-900":"text-gray-800"} line-clamp-2`,title:C.name,children:C.name}),c.jsx("span",{className:"text-[10px] font-black text-blue-700 whitespace-nowrap",children:C.price.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]}),c.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-gray-500 font-bold uppercase tracking-tighter mt-0.5",children:[c.jsxs("span",{className:"flex items-center gap-0.5 bg-gray-200/50 px-1 rounded",children:["SKU: ",C.sku]}),c.jsx("span",{className:"text-gray-300",children:"•"}),c.jsx("span",{className:"truncate",children:C.brand||"Sem Marca"})]})]},k)})})]}),c.jsxs("div",{className:"pt-2 mt-2 border-t border-gray-100 flex justify-between items-center",children:[c.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold bg-gray-100 text-gray-600",children:[c.jsx(De,{className:"w-3 h-3 mr-1"}),b.category.join(", ")]}),b.mainCnae&&c.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[9px] font-medium bg-purple-50 text-purple-700 border border-purple-100 ml-1 truncate max-w-[120px]",title:b.mainCnae,children:b.mainCnae}),c.jsx("a",{href:b.googleMapsUri||`https://www.google.com/maps/dir/?api=1&destination=${b.lat},${b.lng}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:"Rota"})]})]})})})]})})})};export{Kt as default};
